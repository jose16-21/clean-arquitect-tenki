name: Prueba de Tenki Runners

on:
  workflow_dispatch:  # Permite ejecutar manualmente desde GitHub UI
  push:
    branches: [ feature/config-tenki ]

jobs:
  test-tenki-small:
    name: Test con Tenki Small (2 vCPU, 4GB)
    runs-on: tenki-standard-small-2c-4g
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4
      
    - name: â„¹ï¸ Info del runner
      run: |
        echo "ğŸ–¥ï¸ Runner Information:"
        echo "OS: $(uname -a)"
        echo "CPU Cores: $(nproc)"
        echo "RAM: $(free -h | grep Mem | awk '{print $2}')"
        echo "Disk: $(df -h / | tail -1 | awk '{print $2}')"
        
    - name: âš™ï¸ Setup .NET 10
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '10.0.x'
        
    - name: ğŸ”¨ Build
      run: |
        echo "â±ï¸ Inicio: $(date)"
        dotnet build --configuration Release
        echo "âœ… Fin: $(date)"

  test-tenki-medium:
    name: Test con Tenki Medium (4 vCPU, 8GB)
    runs-on: tenki-standard-medium-4c-8g
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4
      
    - name: â„¹ï¸ Info del runner
      run: |
        echo "ğŸ–¥ï¸ Runner Information:"
        echo "OS: $(uname -a)"
        echo "CPU Cores: $(nproc)"
        echo "RAM: $(free -h | grep Mem | awk '{print $2}')"
        echo "Disk: $(df -h / | tail -1 | awk '{print $2}')"
        
    - name: âš™ï¸ Setup .NET 10
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '10.0.x'
        
    - name: ğŸ”¨ Build
      run: |
        echo "â±ï¸ Inicio: $(date)"
        dotnet build --configuration Release
        echo "âœ… Fin: $(date)"

  test-tenki-autoscale:
    name: Test con Tenki Autoscale
    runs-on: tenki-standard-autoscale
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4
      
    - name: â„¹ï¸ Info del runner
      run: |
        echo "ğŸ–¥ï¸ Runner Information (Autoscale):"
        echo "OS: $(uname -a)"
        echo "CPU Cores: $(nproc)"
        echo "RAM: $(free -h | grep Mem | awk '{print $2}')"
        echo "Disk: $(df -h / | tail -1 | awk '{print $2}')"
        
    - name: âš™ï¸ Setup .NET 10
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '10.0.x'
        
    - name: ğŸ”¨ Build y Test
      run: |
        echo "â±ï¸ Inicio: $(date)"
        dotnet restore
        dotnet build --configuration Release --no-restore
        echo "âœ… Fin: $(date)"
        
    - name: ğŸ‰ Resumen
      run: |
        echo "================================================"
        echo "âœ… Build completado con Tenki Autoscale"
        echo "ğŸš€ Tenki es 30% mÃ¡s rÃ¡pido y 90% mÃ¡s barato"
        echo "================================================"
